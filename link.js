/*　■■■■■　ルール　■■■■■　*/
/*　■■■■　命名規則　■■■■　*/
/*　■　関数、変数：camelCase　■　*/
/*　■　クラス：PascalCase　■　*/
/*　■　定数：UPPER_SNAKE_CASE　■　*/

/*　■■■■■　変数・定数　■■■■■　*/
/*　■■■■　定数　■■■■　*/
/*　■■■　グローバル定数　■■■　*/
/*　■　子要素が動的に追加される親要素　■　*/
const resetParentElms = document.getElementsByClassName('reset-child--elm');

/*　■　TLD　■　*/
const tlds = ['AAA','AARP','ABB','ABBOTT','ABBVIE','ABC','ABLE','ABOGADO','ABUDHABI','AC','ACADEMY','ACCENTURE','ACCOUNTANT','ACCOUNTANTS','ACO','ACTOR','AD','ADS','ADULT','AE','AEG','AERO','AETNA','AF','AFL','AFRICA','AG','AGAKHAN','AGENCY','AI','AIG','AIRBUS','AIRFORCE','AIRTEL','AKDN','AL','ALIBABA','ALIPAY','ALLFINANZ','ALLSTATE','ALLY','ALSACE','ALSTOM','AM','AMAZON','AMERICANEXPRESS','AMERICANFAMILY','AMEX','AMFAM','AMICA','AMSTERDAM','ANALYTICS','ANDROID','ANQUAN','ANZ','AO','AOL','APARTMENTS','APP','APPLE','AQ','AQUARELLE','AR','ARAB','ARAMCO','ARCHI','ARMY','ARPA','ART','ARTE','AS','ASDA','ASIA','ASSOCIATES','AT','ATHLETA','ATTORNEY','AU','AUCTION','AUDI','AUDIBLE','AUDIO','AUSPOST','AUTHOR','AUTO','AUTOS','AW','AWS','AX','AXA','AZ','AZURE','BA','BABY','BAIDU','BANAMEX','BAND','BANK','BAR','BARCELONA','BARCLAYCARD','BARCLAYS','BAREFOOT','BARGAINS','BASEBALL','BASKETBALL','BAUHAUS','BAYERN','BB','BBC','BBT','BBVA','BCG','BCN','BD','BE','BEATS','BEAUTY','BEER','BERLIN','BEST','BESTBUY','BET','BF','BG','BH','BHARTI','BI','BIBLE','BID','BIKE','BING','BINGO','BIO','BIZ','BJ','BLACK','BLACKFRIDAY','BLOCKBUSTER','BLOG','BLOOMBERG','BLUE','BM','BMS','BMW','BN','BNPPARIBAS','BO','BOATS','BOEHRINGER','BOFA','BOM','BOND','BOO','BOOK','BOOKING','BOSCH','BOSTIK','BOSTON','BOT','BOUTIQUE','BOX','BR','BRADESCO','BRIDGESTONE','BROADWAY','BROKER','BROTHER','BRUSSELS','BS','BT','BUILD','BUILDERS','BUSINESS','BUY','BUZZ','BV','BW','BY','BZ','BZH','CA','CAB','CAFE','CAL','CALL','CALVINKLEIN','CAM','CAMERA','CAMP','CANON','CAPETOWN','CAPITAL','CAPITALONE','CAR','CARAVAN','CARDS','CARE','CAREER','CAREERS','CARS','CASA','CASE','CASH','CASINO','CAT','CATERING','CATHOLIC','CBA','CBN','CBRE','CC','CD','CENTER','CEO','CERN','CF','CFA','CFD','CG','CH','CHANEL','CHANNEL','CHARITY','CHASE','CHAT','CHEAP','CHINTAI','CHRISTMAS','CHROME','CHURCH','CI','CIPRIANI','CIRCLE','CISCO','CITADEL','CITI','CITIC','CITY','CK','CL','CLAIMS','CLEANING','CLICK','CLINIC','CLINIQUE','CLOTHING','CLOUD','CLUB','CLUBMED','CM','CN','CO','COACH','CODES','COFFEE','COLLEGE','COLOGNE','COM','COMMBANK','COMMUNITY','COMPANY','COMPARE','COMPUTER','COMSEC','CONDOS','CONSTRUCTION','CONSULTING','CONTACT','CONTRACTORS','COOKING','COOL','COOP','CORSICA','COUNTRY','COUPON','COUPONS','COURSES','CPA','CR','CREDIT','CREDITCARD','CREDITUNION','CRICKET','CROWN','CRS','CRUISE','CRUISES','CU','CUISINELLA','CV','CW','CX','CY','CYMRU','CYOU','CZ','DAD','DANCE','DATA','DATE','DATING','DATSUN','DAY','DCLK','DDS','DE','DEAL','DEALER','DEALS','DEGREE','DELIVERY','DELL','DELOITTE','DELTA','DEMOCRAT','DENTAL','DENTIST','DESI','DESIGN','DEV','DHL','DIAMONDS','DIET','DIGITAL','DIRECT','DIRECTORY','DISCOUNT','DISCOVER','DISH','DIY','DJ','DK','DM','DNP','DO','DOCS','DOCTOR','DOG','DOMAINS','DOT','DOWNLOAD','DRIVE','DTV','DUBAI','DUNLOP','DUPONT','DURBAN','DVAG','DVR','DZ','EARTH','EAT','EC','ECO','EDEKA','EDU','EDUCATION','EE','EG','EMAIL','EMERCK','ENERGY','ENGINEER','ENGINEERING','ENTERPRISES','EPSON','EQUIPMENT','ER','ERICSSON','ERNI','ES','ESQ','ESTATE','ET','EU','EUROVISION','EUS','EVENTS','EXCHANGE','EXPERT','EXPOSED','EXPRESS','EXTRASPACE','FAGE','FAIL','FAIRWINDS','FAITH','FAMILY','FAN','FANS','FARM','FARMERS','FASHION','FAST','FEDEX','FEEDBACK','FERRARI','FERRERO','FI','FIDELITY','FIDO','FILM','FINAL','FINANCE','FINANCIAL','FIRE','FIRESTONE','FIRMDALE','FISH','FISHING','FIT','FITNESS','FJ','FK','FLICKR','FLIGHTS','FLIR','FLORIST','FLOWERS','FLY','FM','FO','FOO','FOOD','FOOTBALL','FORD','FOREX','FORSALE','FORUM','FOUNDATION','FOX','FR','FREE','FRESENIUS','FRL','FROGANS','FRONTIER','FTR','FUJITSU','FUN','FUND','FURNITURE','FUTBOL','FYI','GA','GAL','GALLERY','GALLO','GALLUP','GAME','GAMES','GAP','GARDEN','GAY','GB','GBIZ','GD','GDN','GE','GEA','GENT','GENTING','GEORGE','GF','GG','GGEE','GH','GI','GIFT','GIFTS','GIVES','GIVING','GL','GLASS','GLE','GLOBAL','GLOBO','GM','GMAIL','GMBH','GMO','GMX','GN','GODADDY','GOLD','GOLDPOINT','GOLF','GOO','GOODYEAR','GOOG','GOOGLE','GOP','GOT','GOV','GP','GQ','GR','GRAINGER','GRAPHICS','GRATIS','GREEN','GRIPE','GROCERY','GROUP','GS','GT','GU','GUCCI','GUGE','GUIDE','GUITARS','GURU','GW','GY','HAIR','HAMBURG','HANGOUT','HAUS','HBO','HDFC','HDFCBANK','HEALTH','HEALTHCARE','HELP','HELSINKI','HERE','HERMES','HIPHOP','HISAMITSU','HITACHI','HIV','HK','HKT','HM','HN','HOCKEY','HOLDINGS','HOLIDAY','HOMEDEPOT','HOMEGOODS','HOMES','HOMESENSE','HONDA','HORSE','HOSPITAL','HOST','HOSTING','HOT','HOTELS','HOTMAIL','HOUSE','HOW','HR','HSBC','HT','HU','HUGHES','HYATT','HYUNDAI','IBM','ICBC','ICE','ICU','ID','IE','IEEE','IFM','IKANO','IL','IM','IMAMAT','IMDB','IMMO','IMMOBILIEN','IN','INC','INDUSTRIES','INFINITI','INFO','ING','INK','INSTITUTE','INSURANCE','INSURE','INT','INTERNATIONAL','INTUIT','INVESTMENTS','IO','IPIRANGA','IQ','IR','IRISH','IS','ISMAILI','IST','ISTANBUL','IT','ITAU','ITV','JAGUAR','JAVA','JCB','JE','JEEP','JETZT','JEWELRY','JIO','JLL','JM','JMP','JNJ','JO','JOBS','JOBURG','JOT','JOY','JP','JPMORGAN','JPRS','JUEGOS','JUNIPER','KAUFEN','KDDI','KE','KERRYHOTELS','KERRYPROPERTIES','KFH','KG','KH','KI','KIA','KIDS','KIM','KINDLE','KITCHEN','KIWI','KM','KN','KOELN','KOMATSU','KOSHER','KP','KPMG','KPN','KR','KRD','KRED','KUOKGROUP','KW','KY','KYOTO','KZ','LA','LACAIXA','LAMBORGHINI','LAMER','LAND','LANDROVER','LANXESS','LASALLE','LAT','LATINO','LATROBE','LAW','LAWYER','LB','LC','LDS','LEASE','LECLERC','LEFRAK','LEGAL','LEGO','LEXUS','LGBT','LI','LIDL','LIFE','LIFEINSURANCE','LIFESTYLE','LIGHTING','LIKE','LILLY','LIMITED','LIMO','LINCOLN','LINK','LIVE','LIVING','LK','LLC','LLP','LOAN','LOANS','LOCKER','LOCUS','LOL','LONDON','LOTTE','LOTTO','LOVE','LPL','LPLFINANCIAL','LR','LS','LT','LTD','LTDA','LU','LUNDBECK','LUXE','LUXURY','LV','LY','MA','MADRID','MAIF','MAISON','MAKEUP','MAN','MANAGEMENT','MANGO','MAP','MARKET','MARKETING','MARKETS','MARRIOTT','MARSHALLS','MATTEL','MBA','MC','MCKINSEY','MD','ME','MED','MEDIA','MEET','MELBOURNE','MEME','MEMORIAL','MEN','MENU','MERCKMSD','MG','MH','MIAMI','MICROSOFT','MIL','MINI','MINT','MIT','MITSUBISHI','MK','ML','MLB','MLS','MM','MMA','MN','MO','MOBI','MOBILE','MODA','MOE','MOI','MOM','MONASH','MONEY','MONSTER','MORMON','MORTGAGE','MOSCOW','MOTO','MOTORCYCLES','MOV','MOVIE','MP','MQ','MR','MS','MSD','MT','MTN','MTR','MU','MUSEUM','MUSIC','MV','MW','MX','MY','MZ','NA','NAB','NAGOYA','NAME','NAVY','NBA','NC','NE','NEC','NET','NETBANK','NETFLIX','NETWORK','NEUSTAR','NEW','NEWS','NEXT','NEXTDIRECT','NEXUS','NF','NFL','NG','NGO','NHK','NI','NICO','NIKE','NIKON','NINJA','NISSAN','NISSAY','NL','NO','NOKIA','NORTON','NOW','NOWRUZ','NOWTV','NP','NR','NRA','NRW','NTT','NU','NYC','NZ','OBI','OBSERVER','OFFICE','OKINAWA','OLAYAN','OLAYANGROUP','OLLO','OM','OMEGA','ONE','ONG','ONL','ONLINE','OOO','OPEN','ORACLE','ORANGE','ORG','ORGANIC','ORIGINS','OSAKA','OTSUKA','OTT','OVH','PA','PAGE','PANASONIC','PARIS','PARS','PARTNERS','PARTS','PARTY','PAY','PCCW','PE','PET','PF','PFIZER','PG','PH','PHARMACY','PHD','PHILIPS','PHONE','PHOTO','PHOTOGRAPHY','PHOTOS','PHYSIO','PICS','PICTET','PICTURES','PID','PIN','PING','PINK','PIONEER','PIZZA','PK','PL','PLACE','PLAY','PLAYSTATION','PLUMBING','PLUS','PM','PN','PNC','POHL','POKER','POLITIE','PORN','POST','PR','PRAXI','PRESS','PRIME','PRO','PROD','PRODUCTIONS','PROF','PROGRESSIVE','PROMO','PROPERTIES','PROPERTY','PROTECTION','PRU','PRUDENTIAL','PS','PT','PUB','PW','PWC','PY','QA','QPON','QUEBEC','QUEST','RACING','RADIO','RE','READ','REALESTATE','REALTOR','REALTY','RECIPES','RED','REDSTONE','REDUMBRELLA','REHAB','REISE','REISEN','REIT','RELIANCE','REN','RENT','RENTALS','REPAIR','REPORT','REPUBLICAN','REST','RESTAURANT','REVIEW','REVIEWS','REXROTH','RICH','RICHARDLI','RICOH','RIL','RIO','RIP','RO','ROCKS','RODEO','ROGERS','ROOM','RS','RSVP','RU','RUGBY','RUHR','RUN','RW','RWE','RYUKYU','SA','SAARLAND','SAFE','SAFETY','SAKURA','SALE','SALON','SAMSCLUB','SAMSUNG','SANDVIK','SANDVIKCOROMANT','SANOFI','SAP','SARL','SAS','SAVE','SAXO','SB','SBI','SBS','SC','SCB','SCHAEFFLER','SCHMIDT','SCHOLARSHIPS','SCHOOL','SCHULE','SCHWARZ','SCIENCE','SCOT','SD','SE','SEARCH','SEAT','SECURE','SECURITY','SEEK','SELECT','SENER','SERVICES','SEVEN','SEW','SEX','SEXY','SFR','SG','SH','SHANGRILA','SHARP','SHELL','SHIA','SHIKSHA','SHOES','SHOP','SHOPPING','SHOUJI','SHOW','SI','SILK','SINA','SINGLES','SITE','SJ','SK','SKI','SKIN','SKY','SKYPE','SL','SLING','SM','SMART','SMILE','SN','SNCF','SO','SOCCER','SOCIAL','SOFTBANK','SOFTWARE','SOHU','SOLAR','SOLUTIONS','SONG','SONY','SOY','SPA','SPACE','SPORT','SPOT','SR','SRL','SS','ST','STADA','STAPLES','STAR','STATEBANK','STATEFARM','STC','STCGROUP','STOCKHOLM','STORAGE','STORE','STREAM','STUDIO','STUDY','STYLE','SU','SUCKS','SUPPLIES','SUPPLY','SUPPORT','SURF','SURGERY','SUZUKI','SV','SWATCH','SWISS','SX','SY','SYDNEY','SYSTEMS','SZ','TAB','TAIPEI','TALK','TAOBAO','TARGET','TATAMOTORS','TATAR','TATTOO','TAX','TAXI','TC','TCI','TD','TDK','TEAM','TECH','TECHNOLOGY','TEL','TEMASEK','TENNIS','TEVA','TF','TG','TH','THD','THEATER','THEATRE','TIAA','TICKETS','TIENDA','TIPS','TIRES','TIROL','TJ','TJMAXX','TJX','TK','TKMAXX','TL','TM','TMALL','TN','TO','TODAY','TOKYO','TOOLS','TOP','TORAY','TOSHIBA','TOTAL','TOURS','TOWN','TOYOTA','TOYS','TR','TRADE','TRADING','TRAINING','TRAVEL','TRAVELERS','TRAVELERSINSURANCE','TRUST','TRV','TT','TUBE','TUI','TUNES','TUSHU','TV','TVS','TW','TZ','UA','UBANK','UBS','UG','UK','UNICOM','UNIVERSITY','UNO','UOL','UPS','US','UY','UZ','VA','VACATIONS','VANA','VANGUARD','VC','VE','VEGAS','VENTURES','VERISIGN','VERSICHERUNG','VET','VG','VI','VIAJES','VIDEO','VIG','VIKING','VILLAS','VIN','VIP','VIRGIN','VISA','VISION','VIVA','VIVO','VLAANDEREN','VN','VODKA','VOLVO','VOTE','VOTING','VOTO','VOYAGE','VU','WALES','WALMART','WALTER','WANG','WANGGOU','WATCH','WATCHES','WEATHER','WEATHERCHANNEL','WEBCAM','WEBER','WEBSITE','WED','WEDDING','WEIBO','WEIR','WF','WHOSWHO','WIEN','WIKI','WILLIAMHILL','WIN','WINDOWS','WINE','WINNERS','WME','WOLTERSKLUWER','WOODSIDE','WORK','WORKS','WORLD','WOW','WS','WTC','WTF','XBOX','XEROX','XIHUAN','XIN','XN--11B4C3D','XN--1CK2E1B','XN--1QQW23A','XN--2SCRJ9C','XN--30RR7Y','XN--3BST00M','XN--3DS443G','XN--3E0B707E','XN--3HCRJ9C','XN--3PXU8K','XN--42C2D9A','XN--45BR5CYL','XN--45BRJ9C','XN--45Q11C','XN--4DBRK0CE','XN--4GBRIM','XN--54B7FTA0CC','XN--55QW42G','XN--55QX5D','XN--5SU34J936BGSG','XN--5TZM5G','XN--6FRZ82G','XN--6QQ986B3XL','XN--80ADXHKS','XN--80AO21A','XN--80AQECDR1A','XN--80ASEHDB','XN--80ASWG','XN--8Y0A063A','XN--90A3AC','XN--90AE','XN--90AIS','XN--9DBQ2A','XN--9ET52U','XN--9KRT00A','XN--B4W605FERD','XN--BCK1B9A5DRE4C','XN--C1AVG','XN--C2BR7G','XN--CCK2B3B','XN--CCKWCXETD','XN--CG4BKI','XN--CLCHC0EA0B2G2A9GCD','XN--CZR694B','XN--CZRS0T','XN--CZRU2D','XN--D1ACJ3B','XN--D1ALF','XN--E1A4C','XN--ECKVDTC9D','XN--EFVY88H','XN--FCT429K','XN--FHBEI','XN--FIQ228C5HS','XN--FIQ64B','XN--FIQS8S','XN--FIQZ9S','XN--FJQ720A','XN--FLW351E','XN--FPCRJ9C3D','XN--FZC2C9E2C','XN--FZYS8D69UVGM','XN--G2XX48C','XN--GCKR3F0F','XN--GECRJ9C','XN--GK3AT1E','XN--H2BREG3EVE','XN--H2BRJ9C','XN--H2BRJ9C8C','XN--HXT814E','XN--I1B6B1A6A2E','XN--IMR513N','XN--IO0A7I','XN--J1AEF','XN--J1AMH','XN--J6W193G','XN--JLQ480N2RG','XN--JVR189M','XN--KCRX77D1X4A','XN--KPRW13D','XN--KPRY57D','XN--KPUT3I','XN--L1ACC','XN--LGBBAT1AD8J','XN--MGB9AWBF','XN--MGBA3A3EJT','XN--MGBA3A4F16A','XN--MGBA7C0BBN0A','XN--MGBAAM7A8H','XN--MGBAB2BD','XN--MGBAH1A3HJKRD','XN--MGBAI9AZGQP6J','XN--MGBAYH7GPA','XN--MGBBH1A','XN--MGBBH1A71E','XN--MGBC0A9AZCG','XN--MGBCA7DZDO','XN--MGBCPQ6GPA1A','XN--MGBERP4A5D4AR','XN--MGBGU82A','XN--MGBI4ECEXP','XN--MGBPL2FH','XN--MGBT3DHD','XN--MGBTX2B','XN--MGBX4CD0AB','XN--MIX891F','XN--MK1BU44C','XN--MXTQ1M','XN--NGBC5AZD','XN--NGBE9E0A','XN--NGBRX','XN--NODE','XN--NQV7F','XN--NQV7FS00EMA','XN--NYQY26A','XN--O3CW4H','XN--OGBPF8FL','XN--OTU796D','XN--P1ACF','XN--P1AI','XN--PGBS0DH','XN--PSSY2U','XN--Q7CE6A','XN--Q9JYB4C','XN--QCKA1PMC','XN--QXA6A','XN--QXAM','XN--RHQV96G','XN--ROVU88B','XN--RVC1E0AM3E','XN--S9BRJ9C','XN--SES554G','XN--T60B56A','XN--TCKWE','XN--TIQ49XQYJ','XN--UNUP4Y','XN--VERMGENSBERATER-CTB','XN--VERMGENSBERATUNG-PWB','XN--VHQUV','XN--VUQ861B','XN--W4R85EL8FHU5DNRA','XN--W4RS40L','XN--WGBH1C','XN--WGBL6A','XN--XHQ521B','XN--XKC2AL3HYE2A','XN--XKC2DL3A5EE0H','XN--Y9A3AQ','XN--YFRO4I67O','XN--YGBI2AMMX','XN--ZFR164B','XXX','XYZ','YACHTS','YAHOO','YAMAXUN','YANDEX','YE','YODOBASHI','YOGA','YOKOHAMA','YOU','YOUTUBE','YT','YUN','ZA','ZAPPOS','ZARA','ZERO','ZIP','ZM','ZONE','ZUERICH','ZW'];

/*　■■■■　変数　■■■■　*/
/*　■■■　グローバル変数　■■■　*/
let webhookUrl;
let memoValue, memoFangValue;
let now, YYYY, M, MM, D, DD, h, hh, m, mm, s, ss;
let ipv4s = [];
let ipv6s = [];
let cidrs = [];
let urls = [];
let domains = [];
let mails = [];
let macs = [];
let dates = [];
let dateTimes = [];

/*　■■■■■　関数　■■■■■　*/
/*　■■■■　自動実行　■■■■　*/
/*　■■■　ページ読込時　■■■　*/
window.addEventListener('DOMContentLoaded', function() {
	loadItem('memo','footer--textarea');
	memoValue = document.getElementById('footer--textarea').value;
	memoFangValue = memoValue.replace(/hxxps?:/gi,'https:').replace(/\[\.\]|\[dot\]/g,'.');
	let elms = document.getElementsByClassName('save-ls--key-value');
	for (let elm of elms) {
		loadItem(elm.getAttribute('id'),elm.getAttribute('id'));
	}
	extractIndicator();
	analysis();
});

/*　■■■　イベントリスナー　■■■　*/
window.addEventListener('load',function() {
	/*　■■　MEMO更新時　■■　*/
	document.getElementById('footer--textarea').addEventListener('input',(event) => {
		/*　■　MEMO関連　■　*/
		saveItem('memo','footer--textarea');
		memoValue = document.getElementById('footer--textarea').value;
		memoFangValue = memoValue.replace(/hxxps:/gi,'https:').replace(/\[\.\]|\[dot\]/g,'.');
		/*　■　抽出、Analysis、Work　■　*/
		extractIndicator();
		for (resetParentElm of resetParentElms) {
			while(resetParentElm.firstChild) {
				resetParentElm.removeChild(resetParentElm.firstChild);
			}
		}
		analysis();
	});
	/*　■■　Config設定時　■■　*/
	document.getElementById('config--save-btn').addEventListener('click',(event) => {
		let elms = document.getElementsByClassName('save-ls--key-value');
		for (let elm of elms) {
			saveItem(elm.getAttribute('id'),elm.getAttribute('id'));
		}
	});
	/*　■■　CMD-BTN　■■　*/
	const cmdBtns = document.querySelectorAll('.cmd-btn');
	cmdBtns.forEach(function(target) {
		target.addEventListener('click', function() {
			switch (target.dataset.action) {
				case 'copy-memo':
					navigator.clipboard.writeText(memoValue);
					break;
				case 'translate-memo':
					if ( window.confirm('機密情報は含まれていませんか？') ) {
						window.open('https://translate.google.co.jp/?tl=ja&text=' + memoValue.replace(/[\r\n]/g,'%0A'));
					}
					break;
				case 'webhook-memo':
					if ( window.confirm('機密情報は含まれていませんか？') ) {
						const xhr = new XMLHttpRequest();
						let webhookUrl = localStorage.getItem('config--webhook');
						xhr.open("GET",webhookUrl + encodeURIComponent(memoValue));
						xhr.send();
					}
					break;
				case 'restore-memo':
					loadItem('backupMemo','footer--textarea');
					saveItem('memo','footer--textarea');
					break;
				case 'clear-memo':
					saveItem('backupMemo','footer--textarea');
					document.getElementById('footer--textarea').value = '';
					saveItem('memo','footer--textarea');
					break;
			}
		})
	});
});

/*　■■■■　グローバル関数　■■■■　*/
/*　■■■　ローカルストレージ　■■■　*/
/*　■　ローカルストレージに保存　■　*/
function saveItem(key,elmId) {
	let item = document.getElementById(elmId).value;
	localStorage.setItem(key,item);
}

/*　■　ローカルストレージから取得　■　*/
function loadItem(key,elmId) {
	document.getElementById(elmId).value = localStorage.getItem(key);
}

/*　■■■　汎用関数　■■■　*/
/*　■■　日時　■■　*/
function getDateTime() {
	now = new Date();
	separateDateTime(now);
}

/*　■　日時の表示形式　■　*/
function separateDateTime(dateTime) {
	YYYY = dateTime.getFullYear();
	M = dateTime.getMonth() + 1;
	D = dateTime.getDate();
	MM = ('0' + M).slice(-2);
	DD = ('0' + D).slice(-2);
	h = dateTime.getHours();
	m = dateTime.getMinutes();
	s = dateTime.getSeconds();
	hh = ('0' + h).slice(-2);
	mm = ('0' + m).slice(-2);
	ss = ('0' + s).slice(-2);
}

/*　■■　TOTP　■■　*/
function calcTotp(privateKey,otp) {
	let secret = document.getElementById(privateKey).value;
	let b32=s=>[0,8,16,24,32,40,48,56]
		.map(i=>[0,1,2,3,4,5,6,7]
			.map(j=>s.charCodeAt(i+j)).map(c=>c<65?c-24:c-65))
		.map(a=>[(a[0]<<3)+(a[1]>>2),
			(a[1]<<6)+(a[2]<<1)+(a[3]>>4),
			(a[3]<<4)+(a[4]>>1),
			(a[4]<<7)+(a[5]<<2)+(a[6]>>3),
			(a[6]<<5)+(a[7]>>0),
		]).flat(),
		trunc=dv=>dv.getUint32(dv.getInt8(19)&0x0f)&0x7fffffff,
		c=Math.floor(Date.now()/1000/30);
	crypto.subtle.importKey('raw',new Int8Array(b32(secret)),{name:'HMAC',hash:{name:'SHA-1'}},true,['sign'])
		.then(k=>crypto.subtle.sign('HMAC',k,new Int8Array([0,0,0,0,c>>24,c>>16,c>>8,c])))
		.then(h=>document.getElementById(otp).value=('0'+trunc(new DataView(h))).slice(-6));
	crypto.subtle.importKey('raw',new Int8Array(b32(secret)),{name:'HMAC',hash:{name:'SHA-1'}},true,['sign'])
		.then(k=>crypto.subtle.sign('HMAC',k,new Int8Array([0,0,0,0,c>>24,c>>16,c>>8,c])))
		.then(h=>navigator.clipboard.writeText(('0'+trunc(new DataView(h))).slice(-6)));
}

/*　■■　IPアドレス　■■　*/
/*　■　IPレンジ計算　■　*/
function getIpRange(cidr){
	let ipaddress = cidr.split('/'),
			group = ipaddress[0].split('.'),
			ipBit = "",
			minIpBit = "",
			maxIpBit = "",
			tmpMinIpBit = "",
			tmpMaxIpBit = "",
			maxAddress = ipaddress[0];
	// 入力値が空、IPアドレスをカンマ基準で配列にした際に4つじゃない場合
	// ネットワークのビット数が規定の数値(1~32)じゃない場合
	if ( ipaddress === "" || group.length !== 4 ||
			(ipaddress.length === 2 && String(ipaddress[1]).match(/^([1-9]|[1-2][0-9]|3[0-2])$/) === null ) ) {
		return {min:'', max: ''}; // 空を返す
	}
	// IPアドレスのみの場合
	if ( ipaddress.length === 1 ) {
		return {min: convertToBinaryNum(group), max: convertToBinaryNum(group)};
	}
	for ( let i = 0; i < 4; i++ ) {
		let bit = parseInt(group[i], 10).toString(2);
		if ( Number(ipaddress[1]) >= ((i+1)*8) ) {
			ipBit += ("00000000" + bit).slice(-8);
		}
		else {
			let tmpIpBit = ("00000000" + bit).slice(-8);
			minIpBit += ipBit + (tmpIpBit.slice(0, Number(ipaddress[1]) - (i*8)) + "00000000").slice(0, 8);
			maxIpBit += ipBit + (tmpIpBit.slice(0, Number(ipaddress[1]) - (i*8)) + "11111111").slice(0, 8);
			break;
		}
	}
	minIpBit = (minIpBit + "00000000000000000000000000000000").slice(0, 32);
	maxIpBit = (maxIpBit + "11111111111111111111111111111111").slice(0, 32);
	return {min: minIpBit, max: maxIpBit};
}

/*　■　10進数表記ののIPアドレスを2進数に変換　■　*/
function convertToBinaryNum(group){
	let ret = "";
	for ( let i = 0; i < 4; i++ ) {
		let bit = "00000000" + parseInt(group[i], 10).toString(2);
		ret += bit.slice(-8);
	}
	return ret;
}

/*　■　2進数表記のIPアドレスを10進数に変換　■　*/
function convertToIp(num){
	let ret = "";
	ret = parseInt(num.slice(0,8), 2) + ".";
	ret += parseInt(num.slice(8,16), 2) + ".";
	ret += parseInt(num.slice(16,24), 2) + ".";
	ret += parseInt(num.slice(24,32), 2);
	return ret;
}


/*　■■　URL分析　■■　*/
function urlAnalysis(url) {
	let urlObj = {flag: '', url: url};
	let parser = new URL(url);
	urlObj.flag += /https?:\/?[^\/]/.test(url) ? '🤡' : '' ;
	urlObj.flag += /https?:\/{0,2}[^\/]*[𝐀𝐁𝐂𝐃𝐄𝐅𝐆𝐇𝐈𝐉𝐊𝐋𝐌𝐍𝐎𝐏𝐐𝐑𝐒𝐓𝐔𝐕𝐖𝐗𝐘𝐙𝐚𝐛𝐜𝐝𝐞𝐟𝐠𝐡𝐢𝐣𝐤𝐥𝐦𝐧𝐨𝐩𝐪𝐫𝐬𝐭𝐮𝐯𝐰𝐱𝐲𝐳𝐴𝐵𝐶𝐷𝐸𝐹𝐺𝐻𝐼𝐽𝐾𝐿𝑀𝑁𝑂𝑃𝑄𝑅𝑆𝑇𝑈𝑉𝑊𝑋𝑌𝑍𝑎𝑏𝑐𝑑𝑒𝑓𝑔𝑕𝑖𝑗𝑘𝑙𝑚𝑛𝑜𝑝𝑞𝑟𝑠𝑡𝑢𝑣𝑤𝑥𝑦𝑧𝑨𝑩𝑪𝑫𝑬𝑭𝑮𝑯𝑰𝑱𝑲𝑳𝑴𝑵𝑶𝑷𝑸𝑹𝑺𝑻𝑼𝑽𝑾𝑿𝒀𝒁𝒂𝒃𝒄𝒅𝒆𝒇𝒈𝒉𝒊𝒋𝒌𝒍𝒎𝒏𝒐𝒑𝒒𝒓𝒔𝒕𝒖𝒗𝒘𝒙𝒚𝒛𝒜𝒝𝒞𝒟𝒠𝒡𝒢𝒣𝒤𝒥𝒦𝒧𝒨𝒩𝒪𝒫𝒬𝒭𝒮𝒯𝒰𝒱𝒲𝒳𝒴𝒵𝒶𝒷𝒸𝒹𝒺𝒻𝒼𝒽𝒾𝒿𝓀𝓁𝓂𝓃𝓄𝓅𝓆𝓇𝓈𝓉𝓊𝓋𝓌𝓍𝓎𝓏𝓐𝓑𝓒𝓓𝓔𝓕𝓖𝓗𝓘𝓙𝓚𝓛𝓜𝓝𝓞𝓟𝓠𝓡𝓢𝓣𝓤𝓥𝓦𝓧𝓨𝓩𝓪𝓫𝓬𝓭𝓮𝓯𝓰𝓱𝓲𝓳𝓴𝓵𝓶𝓷𝓸𝓹𝓺𝓻𝓼𝓽𝓾𝓿𝔀𝔁𝔂𝔃𝔄𝔅𝔆𝔇𝔈𝔉𝔊𝔋𝔌𝔍𝔎𝔏𝔐𝔑𝔒𝔓𝔔𝔕𝔖𝔗𝔘𝔙𝔚𝔛𝔜𝔝𝔞𝔟𝔠𝔡𝔢𝔣𝔤𝔥𝔦𝔧𝔨𝔩𝔪𝔫𝔬𝔭𝔮𝔯𝔰𝔱𝔲𝔳𝔴𝔵𝔶𝔷𝔸𝔹𝔺𝔻𝔼𝔽𝔾𝔿𝕀𝕁𝕂𝕃𝕄𝕅𝕆𝕇𝕈𝕉𝕊𝕋𝕌𝕍𝕎𝕏𝕐𝕑𝕒𝕓𝕔𝕕𝕖𝕗𝕘𝕙𝕚𝕛𝕜𝕝𝕞𝕟𝕠𝕡𝕢𝕣𝕤𝕥𝕦𝕧𝕨𝕩𝕪𝕫𝕬𝕭𝕮𝕯𝕰𝕱𝕲𝕳𝕴𝕵𝕶𝕷𝕸𝕹𝕺𝕻𝕼𝕽𝕾𝕿𝖀𝖁𝖂𝖃𝖄𝖅𝖆𝖇𝖈𝖉𝖊𝖋𝖌𝖍𝖎𝖏𝖐𝖑𝖒𝖓𝖔𝖕𝖖𝖗𝖘𝖙𝖚𝖛𝖜𝖝𝖞𝖟𝖠𝖡𝖢𝖣𝖤𝖥𝖦𝖧𝖨𝖩𝖪𝖫𝖬𝖭𝖮𝖯𝖰𝖱𝖲𝖳𝖴𝖵𝖶𝖷𝖸𝖹𝖺𝖻𝖼𝖽𝖾𝖿𝗀𝗁𝗂𝗃𝗄𝗅𝗆𝗇𝗈𝗉𝗊𝗋𝗌𝗍𝗎𝗏𝗐𝗑𝗒𝗓𝗔𝗕𝗖𝗗𝗘𝗙𝗚𝗛𝗜𝗝𝗞𝗟𝗠𝗡𝗢𝗣𝗤𝗥𝗦𝗧𝗨𝗩𝗪𝗫𝗬𝗭𝗮𝗯𝗰𝗱𝗲𝗳𝗴𝗵𝗶𝗷𝗸𝗹𝗺𝗻𝗼𝗽𝗾𝗿𝘀𝘁𝘂𝘃𝘄𝘅𝘆𝘇𝘈𝘉𝘊𝘋𝘌𝘍𝘎𝘏𝘐𝘑𝘒𝘓𝘔𝘕𝘖𝘗𝘘𝘙𝘚𝘛𝘜𝘝𝘞𝘟𝘠𝘡𝘢𝘣𝘤𝘥𝘦𝘧𝘨𝘩𝘪𝘫𝘬𝘭𝘮𝘯𝘰𝘱𝘲𝘳𝘴𝘵𝘶𝘷𝘸𝘹𝘺𝘻𝘼𝘽𝘾𝘿𝙀𝙁𝙂𝙃𝙄𝙅𝙆𝙇𝙈𝙉𝙊𝙋𝙌𝙍𝙎𝙏𝙐𝙑𝙒𝙓𝙔𝙕𝙖𝙗𝙘𝙙𝙚𝙛𝙜𝙝𝙞𝙟𝙠𝙡𝙢𝙣𝙤𝙥𝙦𝙧𝙨𝙩𝙪𝙫𝙬𝙭𝙮𝙯𝙰𝙱𝙲𝙳𝙴𝙵𝙶𝙷𝙸𝙹𝙺𝙻𝙼𝙽𝙾𝙿𝚀𝚁𝚂𝚃𝚄𝚅𝚆𝚇𝚈𝚉𝚊𝚋𝚌𝚍𝚎𝚏𝚐𝚑𝚒𝚓𝚔𝚕𝚖𝚗𝚘𝚙𝚚𝚛𝚜𝚝𝚞𝚟𝚠𝚡𝚢𝚣𝚤𝚥𝚦𝚧𝚨𝚩𝚪𝚫𝚬𝚭𝚮𝚯𝚰𝚱𝚲𝚳𝚴𝚵𝚶𝚷𝚸𝚹𝚺𝚻𝚼𝚽𝚾𝚿𝛀𝛁𝛂𝛃𝛄𝛅𝛆𝛇𝛈𝛉𝛊𝛋𝛌𝛍𝛎𝛏𝛐𝛑𝛒𝛓𝛔𝛕𝛖𝛗𝛘𝛙𝛚𝛛𝛜𝛝𝛞𝛟𝛠𝛡𝛢𝛣𝛤𝛥𝛦𝛧𝛨𝛩𝛪𝛫𝛬𝛭𝛮𝛯𝛰𝛱𝛲𝛳𝛴𝛵𝛶𝛷𝛸𝛹𝛺𝛻𝛼𝛽𝛾𝛿𝜀𝜁𝜂𝜃𝜄𝜅𝜆𝜇𝜈𝜉𝜊𝜋𝜌𝜍𝜎𝜏𝜐𝜑𝜒𝜓𝜔𝜕𝜖𝜗𝜘𝜙𝜚𝜛𝜜𝜝𝜞𝜟𝜠𝜡𝜢𝜣𝜤𝜥𝜦𝜧𝜨𝜩𝜪𝜫𝜬𝜭𝜮𝜯𝜰𝜱𝜲𝜳𝜴𝜵𝜶𝜷𝜸𝜹𝜺𝜻𝜼𝜽𝜾𝜿𝝀𝝁𝝂𝝃𝝄𝝅𝝆𝝇𝝈𝝉𝝊𝝋𝝌𝝍𝝎𝝏𝝐𝝑𝝒𝝓𝝔𝝕𝝖𝝗𝝘𝝙𝝚𝝛𝝜𝝝𝝞𝝟𝝠𝝡𝝢𝝣𝝤𝝥𝝦𝝧𝝨𝝩𝝪𝝫𝝬𝝭𝝮𝝯𝝰𝝱𝝲𝝳𝝴𝝵𝝶𝝷𝝸𝝹𝝺𝝻𝝼𝝽𝝾𝝿𝞀𝞁𝞂𝞃𝞄𝞅𝞆𝞇𝞈𝞉𝞊𝞋𝞌𝞍𝞎𝞏𝞐𝞑𝞒𝞓𝞔𝞕𝞖𝞗𝞘𝞙𝞚𝞛𝞜𝞝𝞞𝞟𝞠𝞡𝞢𝞣𝞤𝞥𝞦𝞧𝞨𝞩𝞪𝞫𝞬𝞭𝞮𝞯𝞰𝞱𝞲𝞳𝞴𝞵𝞶𝞷𝞸𝞹𝞺𝞻𝞼𝞽𝞾𝞿𝟀𝟁𝟂𝟃𝟄𝟅𝟆𝟇𝟈𝟉𝟊𝟋𝟌𝟍𝟎𝟏𝟐𝟑𝟒𝟓𝟔𝟕𝟖𝟗𝟘𝟙𝟚𝟛𝟜𝟝𝟞𝟟𝟠𝟡𝟢𝟣𝟤𝟥𝟦𝟧𝟨𝟩𝟪𝟫𝟬𝟭𝟮𝟯𝟰𝟱𝟲𝟳𝟴𝟵𝟶𝟷𝟸𝟹𝟺𝟻𝟼𝟽𝟾𝟿]/.test(url) ? '𝕯' : '' ;
	urlObj.flag += /[∕⁄]/.test(url) ? '➗' : '' ;
	urlObj.flag += /https?:\/{0,2}[^\/]*@[^\/]+/.test(url) ? '🔑' : '' ;
	urlObj.flag += /https?:\/{0,2}([^\/]*@)?translate\.google\.com\//.test(url) ? '📖' : '' ;
	urlObj.flag += /https?:\/{0,2}[\w\-]\.translate\.goog/.test(url) ? '📖' : '' ;
	urlObj.flag += /https?:\/{0,2}www\.google\.com\/url\?/.test(url) ? '➡️' : '' ;
	urlObj.flag += /https?:\/{0,2}[^\/]*[\-\.]?ipfs[\-\.]?[^\/]+/.test(url) ? '🌐' : '' ;
	urlObj.flag += /https?:\/{0,2}[^\/]*\w{16,}/.test(url) ? '🎲' : '' ;
	urlObj.flag += /https?:\/{0,2}[^\/]*[bcdfghjklmnpqrstvwxyz0-9]{8,}/.test(url) ? '🎲' : '' ;
	return urlObj;
}


/*　■■　HTMLリスト作成　■■　*/
function appendHtmlList(parentElm, title, items, linkUrl1='default', linkUrl2, encode) {
	let divElm = document.createElement('div');
	parentElm.appendChild(divElm);
	let hElm = document.createElement('h3');
	hElm.textContent = title;
	divElm.appendChild(hElm);
	let ulElm = document.createElement('ul');
	divElm.appendChild(ulElm);
	for ( let item of items ) {
		let liElm = document.createElement('li');
		ulElm.appendChild(liElm);
		switch (encode) {
			case 'wPercent' :
				decodeItem = encodeURI(encodeURIComponent(item));
				break;
			default :
				decodeItem = item;
		}
		if ( linkUrl1=='default' ) {
			liElm.textContent = title + '：' + item;
		} else {
			let aElm = document.createElement('a');
			aElm.textContent = title + '：' + item;
			aElm.href = linkUrl1 + decodeItem +linkUrl2;
			aElm.target = '_blank';
			liElm.appendChild(aElm);
		}
	}
}

function appendHtmlUl(parentElm, ulId, title) {
	let divElm = document.createElement('div');
	parentElm.appendChild(divElm);
	let hElm = document.createElement('h3');
	hElm.textContent = title;
	/*
	let buttonElm = document.createElement('button');
	buttonElm.className = 'list--copy-btn';
	buttonElm.textContent = 'Copy';
	hElm.appendChild(buttonElm);
	*/
	divElm.appendChild(hElm);
	let ulElm = document.createElement('ul');
	ulElm.id = ulId;
	divElm.appendChild(ulElm);
}

function appendHtmlLi(parentElm, prefix, item, linkUrl='default') {
	let liElm = document.createElement('li');
	parentElm.appendChild(liElm);
	if ( linkUrl=='default' ) {
		liElm.textContent = prefix + item;
		parentElm.appendChild(liElm);
	} else {
		let aElm = document.createElement('a');
		aElm.textContent = prefix + item;
		aElm.href = linkUrl;
		aElm.target = '_blank';
		liElm.appendChild(aElm);
	}
}



/*　■■■　共通関数　■■■　*/
/*　■■　Indicator抽出　■■　*/
function extractIndicator() {
	/*　■　IPv4アドレス抽出（ipv4sに格納）　■　*/
	let dupIpv4s = memoFangValue.match(/(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3})/g);
	ipv4s = new Set(dupIpv4s);
	/*　■　CIDR抽出（cidrsに格納）　■　*/
	let dupCidrs = memoFangValue.match(/(\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}\/\d{1,2})/g);
	cidrs = new Set(dupCidrs);
	/*　■　IPv6アドレス抽出（ipv6sに格納）　■　*/
	let dupIpv6s = memoFangValue.match(/([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])/g);
	ipv6s = new Set(dupIpv6s);
	/*　■　URL抽出（urlsに格納）　■　*/
	let dupUrls = memoFangValue.match(/(https?:\/{0,2}[^\s,]+)/g);
	urls = new Set(dupUrls);
	/*　■　Domain抽出（domainsに格納）　■　*/
	let dupDomains = [];
	for ( let tld of tlds ) {
		let reg = new RegExp('[A-Za-z0-9\\.\\-]+\\.' + tld + '($|[^A-Za-z0-9\\.\\-])', 'gi');
		let tldDomains = memoFangValue.match(reg);
		if ( tldDomains !== null ) {
			dupDomains = [...dupDomains, ...tldDomains];
		}
	}
	let unsortDomains = new Set(dupDomains);
	let undefinedDomains = [...Array(memoFangValue.length)];
	for ( let unsortDomain of unsortDomains ) {
		let idx = memoFangValue.indexOf(unsortDomain);
		undefinedDomains.splice(idx, 1, unsortDomain);
	}
	domains = undefinedDomains.filter(value => value !== undefined);
}

/*　■■■　Analysis　■■　*/
function analysis() {
	const ipOsints = [
		//{ name: '', url1: '', url2: '', encode: '' },
		{ name: 'Whois', url1: 'https://www.whois.com/whois/', url2: '', encode: ''  },
		{ name: 'JPNIC WHOIS', url1: 'https://whois.nic.ad.jp/cgi-bin/whois_gw?key=', url2: '', encode: ''  },
		{ name: 'Virus Total', url1: 'https://www.virustotal.com/gui/ip-address/', url2: '', encode: ''  },
		{ name: 'SHODAN', url1: 'https://www.shodan.io/host/', url2: '', encode: ''  },
	];
	const domainOsints = [
		//{ name: '', url1: '', url2: '', encode: '' },
		{ name: 'Whois', url1: 'https://www.whois.com/whois/', url2: '', encode: ''  },
		{ name: 'Nslookup', url1: 'https://www.nslookup.io/domains/', url2: '/dns-records/', encode: ''  },
	];
	const urlOsints = [
		//{ name: '', url1: '', url2: '', encode: '' },
		{ name: 'Whois', url1: 'https://www.whois.com/whois/', url2: '', encode: ''  },
		{ name: 'Virus Total', url1: 'https://www.virustotal.com/gui/search/', url2: '', encode: 'wPercent'  },
		{ name: 'Google Translate Proxy', url1: 'https://translate.google.com/translate?u=', url2: '', encode: ''  },
	];
	/*　■■　ANALYSIS--IP-ADDRESS　■■　*/
	let elmMAI = document.getElementById('main--analysis--ip-address');
	/*　■　DEFANG-IP-ADDRESS　■　*/
	appendHtmlUl(elmMAI, 'main--analysis--ip-address--defang', 'Defang');
	let elmMAID = document.getElementById('main--analysis--ip-address--defang');
	for ( let ip of ipv4s ){
		let defangIp = ip.replace(/\./g,'[.]');
		appendHtmlLi(elmMAID, '', defangIp);
	}
	/*　■　CIDR　■　*/
	appendHtmlUl(elmMAI, 'main--analysis--ip-address--cidr', 'Cidr');
	let elmMAIC = document.getElementById('main--analysis--ip-address--cidr');
	for ( let cidr of cidrs ) {
		let linkUrl = 'htmlTools/cidr2list.htm?cidr=' + cidr;
		let ipRange = getIpRange(cidr);
		let str = ( ipRange.min !== '' && ipRange.max !== '' ) ? cidr + ' = ' + convertToIp(ipRange.min) + ' - ' + convertToIp(ipRange.max) : '' ;
		appendHtmlLi(elmMAIC, '', str, linkUrl);
	}
	/*　■　OSINT-IP-ADDRESS　■　*/
	for ( let ipOsint of  ipOsints ) {
		let parentElm = document.getElementById('main--analysis--ip-address');
		appendHtmlList(parentElm, ipOsint.name, ipv4s, ipOsint.url1, ipOsint.url2, ipOsint.encode);
	}
	/*　■■　DOMAIN-ANALYSIS　■■　*/
	let elmMAD = document.getElementById('main--analysis--domain');
	/*　■　DOMAIN　■　*/
	appendHtmlUl(elmMAD, 'main--analysis--domain--fang', 'Domain');
	let elmMADF = document.getElementById('main--analysis--domain--fang');
	for ( let domain of domains ){
		appendHtmlLi(elmMADF, '', domain);
	}
	/*　■　DEFANG-DOMAIN　■　*/
	appendHtmlUl(elmMAD, 'main--analysis--domain--defang', 'Defang');
	let elmMADD = document.getElementById('main--analysis--domain--defang');
	for ( let domain of domains ){
		let defangDomain = domain.replace(/\./g,'[.]');
		appendHtmlLi(elmMADD, '', defangDomain);
	}
	/*　■　OSINT-DOMAIN　■　*/
	for ( let domainOsint of  domainOsints ) {
		appendHtmlList(elmMAD, domainOsint.name, domains, domainOsint.url1, domainOsint.url2, domainOsint.encode);
	}

	/*　■■　URL-ANALYSIS　■■　*/
	let elmMAU = document.getElementById('main--analysis--url');
	/*　■　FLAG-URL　■　*/
	let urlDatass = [];
	for ( let url of urls ) {
		let urlObj = urlAnalysis(url);
		urlDatass.push(Object.values(urlObj));
	}
	appendHtmlTable(elmMAU, ['Flag', 'URL'], urlDatass );
	/*　■　DEFANG-URL　■　*/
	appendHtmlUl(elmMAU, 'main--analysis--url--defang', 'Defang');
	let elmMAUD = document.getElementById('main--analysis--url--defang');
	for ( let url of urls ){
		let defangUrl = url.replace(/http/,'hxxp').replace(/\./g,'[.]');
		appendHtmlLi(elmMAUD, '', defangUrl);
	}
	/*　■　OSINT-URL　■　*/
	for ( let urlOsint of  urlOsints ) {
		appendHtmlList(elmMAU, urlOsint.name, urls, urlOsint.url1, urlOsint.url2, urlOsint.encode);
	}
}

function appendHtmlTable(parentElm, headers, datass) {
	let tableElm = document.createElement('table');
	parentElm.appendChild(tableElm);
	let trThElm = document.createElement('tr');
	tableElm.appendChild(trThElm);
	for ( let header of headers ) {
		let thElm = document.createElement('th');
		trThElm.appendChild(thElm);
		thElm.textContent = header;
	}
	for ( let datas of datass ) {
		let trTdElm = document.createElement('tr');
		tableElm.appendChild(trTdElm);
		for ( let data of datas ) {
			let tdElm = document.createElement('td');
			trTdElm.appendChild(tdElm);
			tdElm.textContent = data;
		}
	}
}