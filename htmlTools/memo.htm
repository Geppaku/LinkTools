<!DOCTYPE html>
<html lang="ja">

<head>
	<meta charset="UTF-8">
	<meta name="author" content="Geppaku">
	<link rel="icon" href="../favicon.ico">
	<title>開発中（正規表現の置換のみ可能）</title>
	<!--　■■■■■　CSS　■■■■■　-->
	<style type="text/css">
		html, body, div, p, pre {
			margin: 0;
			padding: 0;
			border: 0;
			font-size: 100%;
			font: inherit;
			vertical-align: baseline;
		}
		html, body {
			height: 100%;
		}
		button, input, select, textarea, pre {
			font-family: inherit;
			font-size: 100%;
		}
		pre {
			display: inline;
		}
		.l--gap--1rem {
			gap: 1rem;
		}
		.l--grid-container--body {
			display: grid;
			height: 100%;
			grid:
				"info header" auto
				"menu main" 1fr
				/auto    1fr;
		}
		.header {
			grid-area: header;
			position: sticky;
			top: 0;
			z-index: 20;
		}
		.menu {
			grid-area: menu;
		}
		.main {
			grid-area: main;
			height: 99%;
			overflow: auto;
			border: 1px solid;
		}
		.l--flex-container {
			display: flex;
		}
		.l--flex-container--column{
			display: flex;
			flex-direction: column;
		}
		.d--highlight {
			background-color: yellow;
		}
		#ln {
			padding: 0.25rem 0.25rem 0.25rem 0.5rem;
			text-align: right;
			color :grey;
			border-right: 1px solid grey;
		}
		#memo {
			width: 100%;
			padding: 0.25rem 0.5rem;
		}
	</style>
</head>

<body>
	<div class="l--grid-container--body">
		<header class="header">
			<div class="l--flex-container">
				<input type="text" id="search-str">
				<button>検索</button>
				<button>Grep</button>
				<button>検索解除</button>
			</div>
			<div class="l--flex-container l--gap--1rem">
				<label><input type="checkbox" id="regex" checked>正規表現</label>
				<label><input type="checkbox" id="case-sensitive">大/小文字を区別</label>
				<label><input type="checkbox" id="search-line" checked>各行検索</label>
			</div>
			<div class="l--flex-container">
				<input type="text" id="replace-str">
				<button>置換</button>
				<label><input type="checkbox" id="replace-all" checked>全て置換</label>
			</div>
		</header>
		<div class="menu l--flex-container--column">
			<button>Fang</button>
			<button>Defang</button>
			<button>重複行削除</button>
			<button>昇順ソート</button>
			<button>降順ソート</button>
			<button>行頭空白削除</button>
			<button>行末空白削除</button>
		</div>
		<main class="main l--flex-container">
			<div id="ln">1</div>
			<div id="memo" contenteditable>hogefugapiyo</div>
		</main>
	</div>
	<!--　■■■■■　JavaScript　■■■■■　-->
	<script type="text/javascript">
		window.onload = function() {
		}
		function countLineNumber() {
			let lineCount = document.getElementById('memo').innerText.match(/\n/g).length;
			lineCount = lineCount==0 ? 1 : lineCount;
			let ln = '';
			for ( let i=1; i<=lineCount; i++) {
				ln += i + '\n';
			}
			document.getElementById('ln').innerText = ln;
		}
		function search() {
		}
		function replace() {
			if( document.getElementById('regex').checked ) {
				let memoElm = document.getElementById('memo');
				let flag = document.getElementById('case-sensitive').checked ? 'i' : '';
				flag += document.getElementById('replace-all').checked ? 'g' : '';
				let lines = memoElm.innerText.split(/\n/);
				let outputStr = '';
				let replaceStr = JSON.parse( "\"" + document.getElementById('replace-str').value.replace(/"/g,'\\"') + "\"");
				for ( let line of lines ) {
					line = line.replace(new RegExp(document.getElementById('search-str').value, flag), replaceStr);
					outputStr += line + '\n';
				}
				memoElm.innerText = outputStr;
			}
		}
	</script>
</body>

</html>